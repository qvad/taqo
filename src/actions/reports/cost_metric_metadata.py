from collections.abc import Mapping


class TableStats:
    def __init__(self, ncols, width):
        self.ncols = ncols
        self.width = width


class ColumnStats:
    def __init__(self, ndv, vmin, vmax, null_frac):
        self.ndv = ndv
        self.vmin = vmin
        self.vmax = vmax
        self.null_frac = null_frac

    def get_avg_value_distance(self):
        return (self.vmax - self.vmin) / (self.ndv - 1)

    def normalize_value(self, value):
        d = self.get_avg_value_distance()
        return (value - self.vmin + d) / (self.vmax - self.vmin + d)


# TODO: move these to data collection and save into .json and combine them with
# CostMetrics.table_row_map and CostMetrics.column_position_map.
# e.g.:
#  select
#    '   "'||tablename||'": TableStats('||count(0)||', '||sum(avg_width)||'),'
#  from pg_stats
#  where tablename in (
#    't1000000c01', 't1000000c02', 't1000000c03', 't1000000c04', 't1000000c05',
#    't1000000c06', 't1000000c07', 't1000000c08', 't1000000c09', 't1000000c10',
#    't100000w125', 't100000w250', 't100000w500', 't100000w1k', 't100000w2k',
#    't100000w3k', 't100000w4k', 't100000w5k', 't100000w6k', 't100000w7k',
#    't100000w8k',
#    't1000000d10','t1000000d20','t1000000d30','t1000000d40','t1000000d50',
#    't1000000d60','t1000000d70','t1000000d80','t1000000d90','t1000000d100',
#    't1000000i','t1000000bi','t1000000flt','t1000000dbl'
#  )
#  group by tablename
#  order by 1;
table_stats_map: Mapping[str: TableStats] = dict({
    "t1000000bi": TableStats(1, 8),
    "t1000000c01": TableStats(1, 4),
    "t1000000c02": TableStats(2, 8),
    "t1000000c03": TableStats(3, 12),
    "t1000000c04": TableStats(4, 16),
    "t1000000c05": TableStats(5, 20),
    "t1000000c06": TableStats(6, 24),
    "t1000000c07": TableStats(7, 28),
    "t1000000c08": TableStats(8, 32),
    "t1000000c09": TableStats(9, 36),
    "t1000000c10": TableStats(10, 40),
    "t1000000d10": TableStats(1, 8),
    "t1000000d100": TableStats(1, 54),
    "t1000000d20": TableStats(1, 14),
    "t1000000d30": TableStats(1, 18),
    "t1000000d40": TableStats(1, 24),
    "t1000000d50": TableStats(1, 28),
    "t1000000d60": TableStats(1, 34),
    "t1000000d70": TableStats(1, 38),
    "t1000000d80": TableStats(1, 44),
    "t1000000d90": TableStats(1, 48),
    "t1000000dbl": TableStats(1, 8),
    "t1000000flt": TableStats(1, 4),
    "t1000000i": TableStats(1, 4),
    "t100000w125": TableStats(1, 126),
    "t100000w1k": TableStats(1, 1004),
    "t100000w250": TableStats(1, 254),
    "t100000w2k": TableStats(1, 2004),
    "t100000w3k": TableStats(1, 3004),
    "t100000w4k": TableStats(1, 4004),
    "t100000w500": TableStats(1, 504),
    "t100000w5k": TableStats(1, 5004),
    "t100000w6k": TableStats(1, 6004),
    "t100000w7k": TableStats(1, 7004),
    "t100000w8k": TableStats(1, 8004),
})

#
# select
#   'select'
#   ||'  ''   "'||relname||'.'||attname||'": ColumnStats(''||count(distinct v)||'', '''
#   ||'  ||min(v)||'', ''||max(v)||'', ''||(count(*) - count(v))/count(*)||''),'''
#   ||'from (select '||attname||' as v from '||relname||') vv;'
# from
#     pg_namespace nc
#     join pg_class c on nc.oid = relnamespace
#     join pg_attribute a on attrelid = c.oid
# where
#     relkind = 'r'
#     and attnum >= 0
#     and nspname in ('public')
# order by
#     nspname,
#     relname,
#     attnum;
#
column_stats_map: Mapping[str: ColumnStats] = dict({
    "t1000000m.c0": ColumnStats(1000000, 1, 1000000, 0),
    "t1000000m.c1": ColumnStats(2, 50, 100, 0),
    "t1000000m.c2": ColumnStats(4, 25, 100, 0),
    "t1000000m.c3": ColumnStats(10, 10, 100, 0),
    "t1000000m.c4": ColumnStats(50, 2, 100, 0),
    "t1000000m.c5": ColumnStats(100000, 1, 100000, 0),
    "t1000000m.c6": ColumnStats(10000, 1, 10000, 0),
    "t1000000c10.c0": ColumnStats(1000000, 1, 1000000, 0),
    "t1000000c10.c1": ColumnStats(1000000, 1, 1000000, 0),
    "t1000000c10.c2": ColumnStats(1000000, 1, 1000000, 0),
    "t1000000c10.c3": ColumnStats(1000000, 1, 1000000, 0),
    "t1000000c10.c4": ColumnStats(1000000, 1, 1000000, 0),
    "t1000000c10.c5": ColumnStats(1000000, 1, 1000000, 0),
    "t1000000c10.c6": ColumnStats(1000000, 1, 1000000, 0),
    "t1000000c10.c7": ColumnStats(1000000, 1, 1000000, 0),
    "t1000000c10.c8": ColumnStats(1000000, 1, 1000000, 0),
    "t1000000c10.c9": ColumnStats(1000000, 1, 1000000, 0),
})

index_prefix_gap_map: Mapping[str: int] = dict({
    ("t1000000m_c1c2c3c4:((c1 <= 50) AND (c2 = 50) AND (c3 = 50))"): 1,
    ("t1000000m_c1c2c3c4:((c1 <= 50) AND (c2 = 50))"): 1,
    ("t1000000m_c1c2c3c4:((c1 = 50) AND (c2 <= 50) AND (c3 = 50))"): 2,
    ("t1000000m_c1c2c3c4:((c1 = 50) AND (c3 = 50))"): 4,
    ("t1000000m_c1c2c3c4:((c2 <= 50) AND (c3 = 50) AND (c4 = 50))"): 4,
    ("t1000000m_c1c2c3c4:((c2 = 50) AND (c3 = 50) AND (c4 <= 50))"): 2,
    ("t1000000m_c1c2c3c4:((c2 = 50) AND (c3 = 50) AND (c4 = 50))"): 2,
    ("t1000000m_c1c2c3c4:((c2 = 50) AND (c3 = 50))"): 2,
    ("t1000000m_c1c2c3c4:((c2 = 50) AND (c4 <= 50))"): 20,
    ("t1000000m_c1c2c3c4:((c2 = 50) AND (c4 = 50))"): 20,
    ("t1000000m_c1c2c3c4:((c3 = 50) AND (c4 = 50))"): 8,
    ("t1000000m_c1c2c3c4:(c2 <= 50)"): 2,
    ("t1000000m_c1c2c3c4:(c2 = 50)"): 2,
    ("t1000000m_c1c2c3c4:(c3 <= 50)"): 8,
    ("t1000000m_c1c2c3c4:(c3 = 10)"): 8,
    ("t1000000m_c1c2c3c4:(c3 = 100)"): 8,
    ("t1000000m_c1c2c3c4:(c3 = 20)"): 8,
    ("t1000000m_c1c2c3c4:(c3 = 30)"): 8,
    ("t1000000m_c1c2c3c4:(c3 = 40)"): 8,
    ("t1000000m_c1c2c3c4:(c3 = 50)"): 8,
    ("t1000000m_c1c2c3c4:(c3 = 60)"): 8,
    ("t1000000m_c1c2c3c4:(c3 = 70)"): 8,
    ("t1000000m_c1c2c3c4:(c3 = 80)"): 8,
    ("t1000000m_c1c2c3c4:(c3 = 90)"): 8,
    ("t1000000m_c1c2c3c4:(c3 = ANY ('{10,20,30,40,50,60,70,80,90,100}'::"
     "integer[]))"): 8,
    ("t1000000m_c1c2c3c4:(c3 = ANY ('{10,20,30,40,50,60,70,80,90}'::integer[]))"): 8,
    ("t1000000m_c1c2c3c4:(c3 = ANY ('{10,20,30,40,50,60,70,80}'::integer[]))"): 8,
    ("t1000000m_c1c2c3c4:(c3 = ANY ('{10,20,30,40,50,60,70}'::integer[]))"): 8,
    ("t1000000m_c1c2c3c4:(c3 = ANY ('{10,20,30,40,50,60}'::integer[]))"): 8,
    ("t1000000m_c1c2c3c4:(c3 = ANY ('{10,20,30,40,50}'::integer[]))"): 8,
    ("t1000000m_c1c2c3c4:(c3 = ANY ('{10,20,30,40}'::integer[]))"): 8,
    ("t1000000m_c1c2c3c4:(c3 = ANY ('{10,20,30}'::integer[]))"): 8,
    ("t1000000m_c1c2c3c4:(c3 = ANY ('{10,20}'::integer[]))"): 8,
    ("t1000000m_c1c2c3c4:(c3 = ANY ('{10,30,50,70,100}'::integer[]))"): 8,
    ("t1000000m_c1c2c3c4:(c3 = ANY ('{10,50,100}'::integer[]))"): 8,
    ("t1000000m_c1c2c3c4:(c3 = ANY ('{20,30,40,50,60,70,80,90,100}'::integer[]))"): 8,
    ("t1000000m_c1c2c3c4:(c3 = ANY ('{30,40,50,60,70,80,90,100}'::integer[]))"): 8,
    ("t1000000m_c1c2c3c4:(c3 = ANY ('{40,50,60,70,80,90,100}'::integer[]))"): 8,
    ("t1000000m_c1c2c3c4:(c3 = ANY ('{50,60,70,80,90,100}'::integer[]))"): 8,
    ("t1000000m_c1c2c3c4:(c3 = ANY ('{60,70,80,90,100}'::integer[]))"): 8,
    ("t1000000m_c1c2c3c4:(c3 = ANY ('{70,80,90,100}'::integer[]))"): 8,
    ("t1000000m_c1c2c3c4:(c3 = ANY ('{80,90,100}'::integer[]))"): 8,
    ("t1000000m_c1c2c3c4:(c3 = ANY ('{90,100}'::integer[]))"): 8,
    ("t1000000m_c1c2c3c4:(c4 <= 1)"): 80,
    ("t1000000m_c1c2c3c4:(c4 <= 10)"): 80,
    ("t1000000m_c1c2c3c4:(c4 <= 100)"): 80,
    ("t1000000m_c1c2c3c4:(c4 <= 2)"): 80,
    ("t1000000m_c1c2c3c4:(c4 <= 20)"): 80,
    ("t1000000m_c1c2c3c4:(c4 <= 30)"): 80,
    ("t1000000m_c1c2c3c4:(c4 <= 40)"): 80,
    ("t1000000m_c1c2c3c4:(c4 <= 50)"): 80,
    ("t1000000m_c1c2c3c4:(c4 <= 60)"): 80,
    ("t1000000m_c1c2c3c4:(c4 <= 70)"): 80,
    ("t1000000m_c1c2c3c4:(c4 <= 80)"): 80,
    ("t1000000m_c1c2c3c4:(c4 <= 90)"): 80,
    ("t1000000m_c1c2c3c4:(c4 = 100)"): 80,
    ("t1000000m_c1c2c3c4:(c4 = 12)"): 80,
    ("t1000000m_c1c2c3c4:(c4 = 2)"): 80,
    ("t1000000m_c1c2c3c4:(c4 = 24)"): 80,
    ("t1000000m_c1c2c3c4:(c4 = 34)"): 80,
    ("t1000000m_c1c2c3c4:(c4 = 44)"): 80,
    ("t1000000m_c1c2c3c4:(c4 = 50)"): 80,
    ("t1000000m_c1c2c3c4:(c4 = 56)"): 80,
    ("t1000000m_c1c2c3c4:(c4 = 66)"): 80,
    ("t1000000m_c1c2c3c4:(c4 = 78)"): 80,
    ("t1000000m_c1c2c3c4:(c4 = 88)"): 80,
    ("t1000000m_c1c2c3c4:(c4 = ANY ('{2,100}'::integer[]))"): 80,
    ("t1000000m_c1c2c3c4:(c4 = ANY ('{2,12,24,34,44,56,66,78,88,100}'::integer[]))"): 80,
    ("t1000000m_c1c2c3c4:(c4 = ANY ('{2,14,26,38,50,64,76,88,100}'::integer[]))"): 80,
    ("t1000000m_c1c2c3c4:(c4 = ANY ('{2,16,30,44,58,72,86,100}'::integer[]))"): 80,
    ("t1000000m_c1c2c3c4:(c4 = ANY ('{2,18,34,38,50,66,84,100}'::integer[]))"): 80,
    ("t1000000m_c1c2c3c4:(c4 = ANY ('{2,20,40,60,80,100}'::integer[]))"): 80,
    ("t1000000m_c1c2c3c4:(c4 = ANY ('{2,26,50,74,100}'::integer[]))"): 80,
    ("t1000000m_c1c2c3c4:(c4 = ANY ('{2,34,66,100}'::integer[]))"): 80,
    ("t1000000m_c1c2c3c4:(c4 = ANY ('{2,50,100}'::integer[]))"): 80,
    ("t1000000m_c3c4c5:((c4 <= 10) AND (c5 = ANY ('{1,1011,2021,3031,4041,5051,"
     "6061,7071,8081,9091,10101,11112,12122,13132,14142,15152,16162,17172,"
     "18182,19192,20202,21212,22223,23233,24243,25253,26263,27273,28283,29293,"
     "30303,31313,32323,33334,34344,35354,36364,37374,38384,39394,40404,41414,"
     "42424,43434,44445,45455,46465,47475,48485,49495,50505,51515,52525,53535,"
     "54545,55556,56566,57576,58586,59596,60606,61616,62626,63636,64646,65656,"
     "66667,67677,68687,69697,70707,71717,72727,73737,74747,75757,76767,77778,"
     "78788,79798,80808,81818,82828,83838,84848,85858,86868,87878,88889,89899,"
     "90909,91919,92929,93939,94949,95959,96969,97979,98989,100000}'::integer[])))"): 50,
    ("t1000000m_c3c4c5:((c4 <= 100) AND (c5 = ANY ('{1,1011,2021,3031,4041,"
     "5051,6061,7071,8081,9091,10101,11112,12122,13132,14142,15152,16162,17172,"
     "18182,19192,20202,21212,22223,23233,24243,25253,26263,27273,28283,29293,"
     "30303,31313,32323,33334,34344,35354,36364,37374,38384,39394,40404,41414,"
     "42424,43434,44445,45455,46465,47475,48485,49495,50505,51515,52525,53535,"
     "54545,55556,56566,57576,58586,59596,60606,61616,62626,63636,64646,65656,"
     "66667,67677,68687,69697,70707,71717,72727,73737,74747,75757,76767,77778,"
     "78788,79798,80808,81818,82828,83838,84848,85858,86868,87878,88889,89899,"
     "90909,91919,92929,93939,94949,95959,96969,97979,98989,100000}'::integer[])))"): 500,
    ("t1000000m_c3c4c5:((c4 <= 2) AND (c5 = ANY ('{1,1011,2021,3031,4041,5051,"
     "6061,7071,8081,9091,10101,11112,12122,13132,14142,15152,16162,17172,"
     "18182,19192,20202,21212,22223,23233,24243,25253,26263,27273,28283,29293,"
     "30303,31313,32323,33334,34344,35354,36364,37374,38384,39394,40404,41414,"
     "42424,43434,44445,45455,46465,47475,48485,49495,50505,51515,52525,53535,"
     "54545,55556,56566,57576,58586,59596,60606,61616,62626,63636,64646,65656,"
     "66667,67677,68687,69697,70707,71717,72727,73737,74747,75757,76767,77778,"
     "78788,79798,80808,81818,82828,83838,84848,85858,86868,87878,88889,89899,"
     "90909,91919,92929,93939,94949,95959,96969,97979,98989,100000}'::integer[])))"): 10,
    ("t1000000m_c3c4c5:((c4 <= 20) AND (c5 = ANY ('{1,1011,2021,3031,4041,5051,"
     "6061,7071,8081,9091,10101,11112,12122,13132,14142,15152,16162,17172,"
     "18182,19192,20202,21212,22223,23233,24243,25253,26263,27273,28283,29293,"
     "30303,31313,32323,33334,34344,35354,36364,37374,38384,39394,40404,41414,"
     "42424,43434,44445,45455,46465,47475,48485,49495,50505,51515,52525,53535,"
     "54545,55556,56566,57576,58586,59596,60606,61616,62626,63636,64646,65656,"
     "66667,67677,68687,69697,70707,71717,72727,73737,74747,75757,76767,77778,"
     "78788,79798,80808,81818,82828,83838,84848,85858,86868,87878,88889,89899,"
     "90909,91919,92929,93939,94949,95959,96969,97979,98989,100000}'::integer[])))"): 100,
    ("t1000000m_c3c4c5:((c4 <= 30) AND (c5 = ANY ('{1,1011,2021,3031,4041,5051,"
     "6061,7071,8081,9091,10101,11112,12122,13132,14142,15152,16162,17172,"
     "18182,19192,20202,21212,22223,23233,24243,25253,26263,27273,28283,29293,"
     "30303,31313,32323,33334,34344,35354,36364,37374,38384,39394,40404,41414,"
     "42424,43434,44445,45455,46465,47475,48485,49495,50505,51515,52525,53535,"
     "54545,55556,56566,57576,58586,59596,60606,61616,62626,63636,64646,65656,"
     "66667,67677,68687,69697,70707,71717,72727,73737,74747,75757,76767,77778,"
     "78788,79798,80808,81818,82828,83838,84848,85858,86868,87878,88889,89899,"
     "90909,91919,92929,93939,94949,95959,96969,97979,98989,100000}'::integer[])))"): 150,
    ("t1000000m_c3c4c5:((c4 <= 40) AND (c5 = ANY ('{1,1011,2021,3031,4041,5051,"
     "6061,7071,8081,9091,10101,11112,12122,13132,14142,15152,16162,17172,"
     "18182,19192,20202,21212,22223,23233,24243,25253,26263,27273,28283,29293,"
     "30303,31313,32323,33334,34344,35354,36364,37374,38384,39394,40404,41414,"
     "42424,43434,44445,45455,46465,47475,48485,49495,50505,51515,52525,53535,"
     "54545,55556,56566,57576,58586,59596,60606,61616,62626,63636,64646,65656,"
     "66667,67677,68687,69697,70707,71717,72727,73737,74747,75757,76767,77778,"
     "78788,79798,80808,81818,82828,83838,84848,85858,86868,87878,88889,89899,"
     "90909,91919,92929,93939,94949,95959,96969,97979,98989,100000}'::integer[])))"): 200,
    ("t1000000m_c3c4c5:((c4 <= 50) AND (c5 = ANY ('{1,1011,2021,3031,4041,5051,"
     "6061,7071,8081,9091,10101,11112,12122,13132,14142,15152,16162,17172,"
     "18182,19192,20202,21212,22223,23233,24243,25253,26263,27273,28283,29293,"
     "30303,31313,32323,33334,34344,35354,36364,37374,38384,39394,40404,41414,"
     "42424,43434,44445,45455,46465,47475,48485,49495,50505,51515,52525,53535,"
     "54545,55556,56566,57576,58586,59596,60606,61616,62626,63636,64646,65656,"
     "66667,67677,68687,69697,70707,71717,72727,73737,74747,75757,76767,77778,"
     "78788,79798,80808,81818,82828,83838,84848,85858,86868,87878,88889,89899,"
     "90909,91919,92929,93939,94949,95959,96969,97979,98989,100000}'::integer[])))"): 250,
    ("t1000000m_c3c4c5:((c4 <= 60) AND (c5 = ANY ('{1,1011,2021,3031,4041,5051,"
     "6061,7071,8081,9091,10101,11112,12122,13132,14142,15152,16162,17172,"
     "18182,19192,20202,21212,22223,23233,24243,25253,26263,27273,28283,29293,"
     "30303,31313,32323,33334,34344,35354,36364,37374,38384,39394,40404,41414,"
     "42424,43434,44445,45455,46465,47475,48485,49495,50505,51515,52525,53535,"
     "54545,55556,56566,57576,58586,59596,60606,61616,62626,63636,64646,65656,"
     "66667,67677,68687,69697,70707,71717,72727,73737,74747,75757,76767,77778,"
     "78788,79798,80808,81818,82828,83838,84848,85858,86868,87878,88889,89899,"
     "90909,91919,92929,93939,94949,95959,96969,97979,98989,100000}'::integer[])))"): 300,
    ("t1000000m_c3c4c5:((c4 <= 70) AND (c5 = ANY ('{1,1011,2021,3031,4041,5051,"
     "6061,7071,8081,9091,10101,11112,12122,13132,14142,15152,16162,17172,"
     "18182,19192,20202,21212,22223,23233,24243,25253,26263,27273,28283,29293,"
     "30303,31313,32323,33334,34344,35354,36364,37374,38384,39394,40404,41414,"
     "42424,43434,44445,45455,46465,47475,48485,49495,50505,51515,52525,53535,"
     "54545,55556,56566,57576,58586,59596,60606,61616,62626,63636,64646,65656,"
     "66667,67677,68687,69697,70707,71717,72727,73737,74747,75757,76767,77778,"
     "78788,79798,80808,81818,82828,83838,84848,85858,86868,87878,88889,89899,"
     "90909,91919,92929,93939,94949,95959,96969,97979,98989,100000}'::integer[])))"): 350,
    ("t1000000m_c3c4c5:((c4 <= 80) AND (c5 = ANY ('{1,1011,2021,3031,4041,5051,"
     "6061,7071,8081,9091,10101,11112,12122,13132,14142,15152,16162,17172,"
     "18182,19192,20202,21212,22223,23233,24243,25253,26263,27273,28283,29293,"
     "30303,31313,32323,33334,34344,35354,36364,37374,38384,39394,40404,41414,"
     "42424,43434,44445,45455,46465,47475,48485,49495,50505,51515,52525,53535,"
     "54545,55556,56566,57576,58586,59596,60606,61616,62626,63636,64646,65656,"
     "66667,67677,68687,69697,70707,71717,72727,73737,74747,75757,76767,77778,"
     "78788,79798,80808,81818,82828,83838,84848,85858,86868,87878,88889,89899,"
     "90909,91919,92929,93939,94949,95959,96969,97979,98989,100000}'::integer[])))"): 400,
    ("t1000000m_c3c4c5:((c4 <= 90) AND (c5 = ANY ('{1,1011,2021,3031,4041,5051,"
     "6061,7071,8081,9091,10101,11112,12122,13132,14142,15152,16162,17172,"
     "18182,19192,20202,21212,22223,23233,24243,25253,26263,27273,28283,29293,"
     "30303,31313,32323,33334,34344,35354,36364,37374,38384,39394,40404,41414,"
     "42424,43434,44445,45455,46465,47475,48485,49495,50505,51515,52525,53535,"
     "54545,55556,56566,57576,58586,59596,60606,61616,62626,63636,64646,65656,"
     "66667,67677,68687,69697,70707,71717,72727,73737,74747,75757,76767,77778,"
     "78788,79798,80808,81818,82828,83838,84848,85858,86868,87878,88889,89899,"
     "90909,91919,92929,93939,94949,95959,96969,97979,98989,100000}'::integer[])))"): 450,
    ("t1000000m_c3c4c5:((c4 = 50) AND (c5 = ANY ('{1,1011,2021,3031,4041,5051,"
     "6061,7071,8081,9091,10101,11112,12122,13132,14142,15152,16162,17172,"
     "18182,19192,20202,21212,22223,23233,24243,25253,26263,27273,28283,29293,"
     "30303,31313,32323,33334,34344,35354,36364,37374,38384,39394,40404,41414,"
     "42424,43434,44445,45455,46465,47475,48485,49495,50505,51515,52525,53535,"
     "54545,55556,56566,57576,58586,59596,60606,61616,62626,63636,64646,65656,"
     "66667,67677,68687,69697,70707,71717,72727,73737,74747,75757,76767,77778,"
     "78788,79798,80808,81818,82828,83838,84848,85858,86868,87878,88889,89899,"
     "90909,91919,92929,93939,94949,95959,96969,97979,98989,100000}'::integer[])))"): 10,
    ("t1000000m_c3c4c5:((c4 = ANY ('{2,100}'::integer[])) AND (c5 = ANY ('{1,"
     "1011,2021,3031,4041,5051,6061,7071,8081,9091,10101,11112,12122,13132,"
     "14142,15152,16162,17172,18182,19192,20202,21212,22223,23233,24243,25253,"
     "26263,27273,28283,29293,30303,31313,32323,33334,34344,35354,36364,37374,"
     "38384,39394,40404,41414,42424,43434,44445,45455,46465,47475,48485,49495,"
     "50505,51515,52525,53535,54545,55556,56566,57576,58586,59596,60606,61616,"
     "62626,63636,64646,65656,66667,67677,68687,69697,70707,71717,72727,73737,"
     "74747,75757,76767,77778,78788,79798,80808,81818,82828,83838,84848,85858,"
     "86868,87878,88889,89899,90909,91919,92929,93939,94949,95959,96969,97979,"
     "98989,100000}'::integer[])))"): 10,
    ("t1000000m_c3c4c5:((c4 = ANY ('{2,12,24,34,44,56,66,78,88,100}'::integer[])) "
     "AND (c5 = ANY ('{1,1011,2021,3031,4041,5051,6061,7071,8081,9091,10101,"
     "11112,12122,13132,14142,15152,16162,17172,18182,19192,20202,21212,22223,"
     "23233,24243,25253,26263,27273,28283,29293,30303,31313,32323,33334,34344,"
     "35354,36364,37374,38384,39394,40404,41414,42424,43434,44445,45455,46465,"
     "47475,48485,49495,50505,51515,52525,53535,54545,55556,56566,57576,58586,"
     "59596,60606,61616,62626,63636,64646,65656,66667,67677,68687,69697,70707,"
     "71717,72727,73737,74747,75757,76767,77778,78788,79798,80808,81818,82828,"
     "83838,84848,85858,86868,87878,88889,89899,90909,91919,92929,93939,94949,"
     "95959,96969,97979,98989,100000}'::integer[])))"): 10,
    ("t1000000m_c3c4c5:((c4 = ANY ('{2,14,26,38,50,64,76,88,100}'::integer[])) "
     "AND (c5 = ANY ('{1,1011,2021,3031,4041,5051,6061,7071,8081,9091,10101,"
     "11112,12122,13132,14142,15152,16162,17172,18182,19192,20202,21212,22223,"
     "23233,24243,25253,26263,27273,28283,29293,30303,31313,32323,33334,34344,"
     "35354,36364,37374,38384,39394,40404,41414,42424,43434,44445,45455,46465,"
     "47475,48485,49495,50505,51515,52525,53535,54545,55556,56566,57576,58586,"
     "59596,60606,61616,62626,63636,64646,65656,66667,67677,68687,69697,70707,"
     "71717,72727,73737,74747,75757,76767,77778,78788,79798,80808,81818,82828,"
     "83838,84848,85858,86868,87878,88889,89899,90909,91919,92929,93939,94949,"
     "95959,96969,97979,98989,100000}'::integer[])))"): 10,
    ("t1000000m_c3c4c5:((c4 = ANY ('{2,16,30,44,58,72,86,100}'::integer[])) "
     "AND (c5 = ANY ('{1,1011,2021,3031,4041,5051,6061,7071,8081,9091,10101,"
     "11112,12122,13132,14142,15152,16162,17172,18182,19192,20202,21212,22223,"
     "23233,24243,25253,26263,27273,28283,29293,30303,31313,32323,33334,34344,"
     "35354,36364,37374,38384,39394,40404,41414,42424,43434,44445,45455,46465,"
     "47475,48485,49495,50505,51515,52525,53535,54545,55556,56566,57576,58586,"
     "59596,60606,61616,62626,63636,64646,65656,66667,67677,68687,69697,70707,"
     "71717,72727,73737,74747,75757,76767,77778,78788,79798,80808,81818,82828,"
     "83838,84848,85858,86868,87878,88889,89899,90909,91919,92929,93939,94949,"
     "95959,96969,97979,98989,100000}'::integer[])))"): 10,
    ("t1000000m_c3c4c5:((c4 = ANY ('{2,18,34,38,50,66,84,100}'::integer[])) "
     "AND (c5 = ANY ('{1,1011,2021,3031,4041,5051,6061,7071,8081,9091,10101,"
     "11112,12122,13132,14142,15152,16162,17172,18182,19192,20202,21212,22223,"
     "23233,24243,25253,26263,27273,28283,29293,30303,31313,32323,33334,34344,"
     "35354,36364,37374,38384,39394,40404,41414,42424,43434,44445,45455,46465,"
     "47475,48485,49495,50505,51515,52525,53535,54545,55556,56566,57576,58586,"
     "59596,60606,61616,62626,63636,64646,65656,66667,67677,68687,69697,70707,"
     "71717,72727,73737,74747,75757,76767,77778,78788,79798,80808,81818,82828,"
     "83838,84848,85858,86868,87878,88889,89899,90909,91919,92929,93939,94949,"
     "95959,96969,97979,98989,100000}'::integer[])))"): 10,
    ("t1000000m_c3c4c5:((c4 = ANY ('{2,20,40,60,80,100}'::integer[])) AND (c5 = "
     "ANY ('{1,1011,2021,3031,4041,5051,6061,7071,8081,9091,10101,11112,12122,"
     "13132,14142,15152,16162,17172,18182,19192,20202,21212,22223,23233,24243,"
     "25253,26263,27273,28283,29293,30303,31313,32323,33334,34344,35354,36364,"
     "37374,38384,39394,40404,41414,42424,43434,44445,45455,46465,47475,48485,"
     "49495,50505,51515,52525,53535,54545,55556,56566,57576,58586,59596,60606,"
     "61616,62626,63636,64646,65656,66667,67677,68687,69697,70707,71717,72727,"
     "73737,74747,75757,76767,77778,78788,79798,80808,81818,82828,83838,84848,"
     "85858,86868,87878,88889,89899,90909,91919,92929,93939,94949,95959,96969,"
     "97979,98989,100000}'::integer[])))"): 10,
    ("t1000000m_c3c4c5:((c4 = ANY ('{2,26,50,74,100}'::integer[])) AND (c5 = "
     "ANY ('{1,1011,2021,3031,4041,5051,6061,7071,8081,9091,10101,11112,12122,"
     "13132,14142,15152,16162,17172,18182,19192,20202,21212,22223,23233,24243,"
     "25253,26263,27273,28283,29293,30303,31313,32323,33334,34344,35354,36364,"
     "37374,38384,39394,40404,41414,42424,43434,44445,45455,46465,47475,48485,"
     "49495,50505,51515,52525,53535,54545,55556,56566,57576,58586,59596,60606,"
     "61616,62626,63636,64646,65656,66667,67677,68687,69697,70707,71717,72727,"
     "73737,74747,75757,76767,77778,78788,79798,80808,81818,82828,83838,84848,"
     "85858,86868,87878,88889,89899,90909,91919,92929,93939,94949,95959,96969,"
     "97979,98989,100000}'::integer[])))"): 10,
    ("t1000000m_c3c4c5:((c4 = ANY ('{2,34,66,100}'::integer[])) AND (c5 = ANY ('{"
     "1,1011,2021,3031,4041,5051,6061,7071,8081,9091,10101,11112,12122,13132,"
     "14142,15152,16162,17172,18182,19192,20202,21212,22223,23233,24243,25253,"
     "26263,27273,28283,29293,30303,31313,32323,33334,34344,35354,36364,37374,"
     "38384,39394,40404,41414,42424,43434,44445,45455,46465,47475,48485,49495,"
     "50505,51515,52525,53535,54545,55556,56566,57576,58586,59596,60606,61616,"
     "62626,63636,64646,65656,66667,67677,68687,69697,70707,71717,72727,73737,"
     "74747,75757,76767,77778,78788,79798,80808,81818,82828,83838,84848,85858,"
     "86868,87878,88889,89899,90909,91919,92929,93939,94949,95959,96969,97979,"
     "98989,100000}'::integer[])))"): 10,
    ("t1000000m_c3c4c5:((c4 = ANY ('{2,50,100}'::integer[])) AND (c5 = ANY ('{"
     "1,1011,2021,3031,4041,5051,6061,7071,8081,9091,10101,11112,12122,13132,"
     "14142,15152,16162,17172,18182,19192,20202,21212,22223,23233,24243,25253,"
     "26263,27273,28283,29293,30303,31313,32323,33334,34344,35354,36364,37374,"
     "38384,39394,40404,41414,42424,43434,44445,45455,46465,47475,48485,49495,"
     "50505,51515,52525,53535,54545,55556,56566,57576,58586,59596,60606,61616,"
     "62626,63636,64646,65656,66667,67677,68687,69697,70707,71717,72727,73737,"
     "74747,75757,76767,77778,78788,79798,80808,81818,82828,83838,84848,85858,"
     "86868,87878,88889,89899,90909,91919,92929,93939,94949,95959,96969,97979,"
     "98989,100000}'::integer[])))"): 10,
    ("t1000000m_c3c4c5:(c4 <= 1)"): 10,
    ("t1000000m_c3c4c5:(c4 <= 50)"): 10,
    ("t1000000m_c3c4c5:(c4 = 100)"): 10,
    ("t1000000m_c3c4c5:(c4 = 12)"): 10,
    ("t1000000m_c3c4c5:(c4 = 2)"): 10,
    ("t1000000m_c3c4c5:(c4 = 24)"): 10,
    ("t1000000m_c3c4c5:(c4 = 34)"): 10,
    ("t1000000m_c3c4c5:(c4 = 44)"): 10,
    ("t1000000m_c3c4c5:(c4 = 50)"): 10,
    ("t1000000m_c3c4c5:(c4 = 56)"): 10,
    ("t1000000m_c3c4c5:(c4 = 66)"): 10,
    ("t1000000m_c3c4c5:(c4 = 78)"): 10,
    ("t1000000m_c3c4c5:(c4 = 88)"): 10,
    ("t1000000m_c3c4c5:(c5 = 1)"): 500,
    ("t1000000m_c3c4c5:(c5 = 100000)"): 500,
    ("t1000000m_c3c4c5:(c5 = 10101)"): 500,
    ("t1000000m_c3c4c5:(c5 = 20202)"): 500,
    ("t1000000m_c3c4c5:(c5 = 30303)"): 500,
    ("t1000000m_c3c4c5:(c5 = 40404)"): 500,
    ("t1000000m_c3c4c5:(c5 = 50505)"): 500,
    ("t1000000m_c3c4c5:(c5 = 60606)"): 500,
    ("t1000000m_c3c4c5:(c5 = 70707)"): 500,
    ("t1000000m_c3c4c5:(c5 = 80808)"): 500,
    ("t1000000m_c3c4c5:(c5 = ANY ('{1,1011,2021,3031,4041,5051,6061,7071,8081,"
     "9091,10101,11112,12122,13132,14142,15152,16162,17172,18182,19192,20202,"
     "21212,22223,23233,24243,25253,26263,27273,28283,29293,30303,31313,32323,"
     "33334,34344,35354,36364,37374,38384,39394,40404,41414,42424,43434,44445,"
     "45455,46465,47475,48485,49495,50505,51515,52525,53535,54545,55556,56566,"
     "57576,58586,59596,60606,61616,62626,63636,64646,65656,66667,67677,68687,"
     "69697,70707,71717,72727,73737,74747,75757,76767,77778,78788,79798,80808,"
     "81818,82828,83838,84848,85858,86868,87878,88889,89899,90909,91919,92929,"
     "93939,94949,95959,96969,97979,98989,100000}'::integer[]))"): 500,
    ("t1000000m_c3c4c5:(c5 = ANY ('{1,12500,25000,35700,50000,62500,75000,"
     "87500,100000}'::integer[]))"): 500,
    ("t1000000m_c3c4c5:(c5 = ANY ('{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,"
     "18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,"
     "42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,"
     "66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,"
     "90,91,92,93,94,95,96,97,98,99,100}'::integer[]))"): 500,
    ("t1000000m_c3c4c5:(c5 = ANY ('{1,2,3,4,5,6,7,8,9,10}'::integer[]))"): 500,
    ("t1000000m_c3c4c5:(c5 = ANY ('{1,2,3,4,5}'::integer[]))"): 500,
    ("t1000000m_c3c4c5:(c5 = ANY ('{1,25000,50000,75000,100000}'::integer[]))"): 500,
    ("t1000000m_c3c4c5:(c5 = ANY ('{1,2}'::integer[]))"): 500,
    ("t1000000m_c3c4c5:(c5 = ANY ('{99901,99902,99903,99904,99905,99906,99907,"
     "99908,99909,99910,99911,99912,99913,99914,99915,99916,99917,99918,99919,"
     "99920,99921,99922,99923,99924,99925,99926,99927,99928,99929,99930,99931,"
     "99932,99933,99934,99935,99936,99937,99938,99939,99940,99941,99942,99943,"
     "99944,99945,99946,99947,99948,99949,99950,99951,99952,99953,99954,99955,"
     "99956,99957,99958,99959,99960,99961,99962,99963,99964,99965,99966,99967,"
     "99968,99969,99970,99971,99972,99973,99974,99975,99976,99977,99978,99979,"
     "99980,99981,99982,99983,99984,99985,99986,99987,99988,99989,99990,99991,"
     "99992,99993,99994,99995,99996,99997,99998,99999,100000}'::integer[]))"): 500,
    ("t1000000m_c3c4c5:(c5 = ANY ('{99991,99992,99993,99994,99995,99996,99997,"
     "99998,99999,100000}'::integer[]))"): 500,
    ("t1000000m_c3c4c5:(c5 = ANY ('{99992,99993,99994,99995,99996,99997,99998,"
     "99999,100000}'::integer[]))"): 500,
    ("t1000000m_c3c4c5:(c5 = ANY ('{99993,99994,99995,99996,99997,99998,99999,"
     "100000}'::integer[]))"): 500,
    ("t1000000m_c3c4c5:(c5 = ANY ('{99994,99995,99996,99997,99998,99999,100000}'::"
     "integer[]))"): 500,
    ("t1000000m_c3c4c5:(c5 = ANY ('{99995,99996,99997,99998,99999,100000}'::"
     "integer[]))"): 500,
    ("t1000000m_c3c4c5:(c5 = ANY ('{99996,99997,99998,99999,100000}'::integer[]))"): 500,
    ("t1000000m_c3c4c5:(c5 = ANY ('{99997,99998,99999,100000}'::integer[]))"): 500,
    ("t1000000m_c3c4c5:(c5 = ANY ('{99998,99999,100000}'::integer[]))"): 500,
    ("t1000000m_c3c4c5:(c5 = ANY ('{99999,100000}'::integer[]))"): 500,
    ("t1000000m_c4c2c3c1:((c2 <= 50) AND (c3 = 50) AND (c1 = 50))"): 100,
    ("t1000000m_c4c2c3c1:((c2 = 50) AND (c1 <= 50))"): 500,
    ("t1000000m_c4c2c3c1:((c2 = 50) AND (c1 = 50))"): 500,
    ("t1000000m_c4c2c3c1:((c2 = 50) AND (c3 = 50) AND (c1 <= 50))"): 50,
    ("t1000000m_c4c2c3c1:((c2 = 50) AND (c3 = 50) AND (c1 = 50))"): 50,
    ("t1000000m_c4c2c3c1:((c2 = 50) AND (c3 = 50))"): 50,
    ("t1000000m_c4c2c3c1:((c3 = 50) AND (c1 = 50))"): 200,
    ("t1000000m_c4c2c3c1:((c4 <= 50) AND (c2 = 50) AND (c3 = 50))"): 25,
    ("t1000000m_c4c2c3c1:((c4 <= 50) AND (c2 = 50))"): 25,
    ("t1000000m_c4c2c3c1:((c4 = 50) AND (c2 <= 50) AND (c3 = 50))"): 2,
    ("t1000000m_c4c2c3c1:((c4 = 50) AND (c3 = 50))"): 4,
    ("t1000000m_c4c2c3c1:(c1 <= 50)"): 2000,
    ("t1000000m_c4c2c3c1:(c1 = 50)"): 2000,
    ("t1000000m_c4c2c3c1:(c2 <= 50)"): 50,
    ("t1000000m_c4c2c3c1:(c2 = 50)"): 50,
    ("t1000000m_c4c2c3c1:(c3 <= 50)"): 200,
    ("t1000000m_c4c2c3c1:(c3 = 10)"): 200,
    ("t1000000m_c4c2c3c1:(c3 = 100)"): 200,
    ("t1000000m_c4c2c3c1:(c3 = 20)"): 200,
    ("t1000000m_c4c2c3c1:(c3 = 30)"): 200,
    ("t1000000m_c4c2c3c1:(c3 = 40)"): 200,
    ("t1000000m_c4c2c3c1:(c3 = 50)"): 200,
    ("t1000000m_c4c2c3c1:(c3 = 60)"): 200,
    ("t1000000m_c4c2c3c1:(c3 = 70)"): 200,
    ("t1000000m_c4c2c3c1:(c3 = 80)"): 200,
    ("t1000000m_c4c2c3c1:(c3 = 90)"): 200,
    ("t1000000m_c4c2c3c1:(c3 = ANY ('{10,20,30,40,50,60,70,80,90,100}'::"
     "integer[]))"): 200,
    ("t1000000m_c4c2c3c1:(c3 = ANY ('{10,20,30,40,50,60,70,80,90}'::integer[]))"): 200,
    ("t1000000m_c4c2c3c1:(c3 = ANY ('{10,20,30,40,50,60,70,80}'::integer[]))"): 200,
    ("t1000000m_c4c2c3c1:(c3 = ANY ('{10,20,30,40,50,60,70}'::integer[]))"): 200,
    ("t1000000m_c4c2c3c1:(c3 = ANY ('{10,20,30,40,50,60}'::integer[]))"): 200,
    ("t1000000m_c4c2c3c1:(c3 = ANY ('{10,20,30,40,50}'::integer[]))"): 200,
    ("t1000000m_c4c2c3c1:(c3 = ANY ('{10,20,30,40}'::integer[]))"): 200,
    ("t1000000m_c4c2c3c1:(c3 = ANY ('{10,20,30}'::integer[]))"): 200,
    ("t1000000m_c4c2c3c1:(c3 = ANY ('{10,20}'::integer[]))"): 200,
    ("t1000000m_c4c2c3c1:(c3 = ANY ('{10,30,50,70,100}'::integer[]))"): 200,
    ("t1000000m_c4c2c3c1:(c3 = ANY ('{10,50,100}'::integer[]))"): 200,
    ("t1000000m_c4c2c3c1:(c3 = ANY ('{20,30,40,50,60,70,80,90,100}'::integer[]))"): 200,
    ("t1000000m_c4c2c3c1:(c3 = ANY ('{30,40,50,60,70,80,90,100}'::integer[]))"): 200,
    ("t1000000m_c4c2c3c1:(c3 = ANY ('{40,50,60,70,80,90,100}'::integer[]))"): 200,
    ("t1000000m_c4c2c3c1:(c3 = ANY ('{50,60,70,80,90,100}'::integer[]))"): 200,
    ("t1000000m_c4c2c3c1:(c3 = ANY ('{60,70,80,90,100}'::integer[]))"): 200,
    ("t1000000m_c4c2c3c1:(c3 = ANY ('{70,80,90,100}'::integer[]))"): 200,
    ("t1000000m_c4c2c3c1:(c3 = ANY ('{80,90,100}'::integer[]))"): 200,
    ("t1000000m_c4c2c3c1:(c3 = ANY ('{90,100}'::integer[]))"): 200,
    ("t1000000m_c5c4c3:((c4 <= 50) AND (c3 = 50))"): 457403,
    ("t1000000m_c5c4c3:((c4 = 50) AND (c3 = 50))"): 100000,
    ("t1000000m_c5c4c3:(c3 <= 50)"): 914738,
    ("t1000000m_c5c4c3:(c3 = 10)"): 914738,
    ("t1000000m_c5c4c3:(c3 = 100)"): 914738,
    ("t1000000m_c5c4c3:(c3 = 20)"): 914738,
    ("t1000000m_c5c4c3:(c3 = 30)"): 914738,
    ("t1000000m_c5c4c3:(c3 = 40)"): 914738,
    ("t1000000m_c5c4c3:(c3 = 50)"): 914738,
    ("t1000000m_c5c4c3:(c3 = 60)"): 914738,
    ("t1000000m_c5c4c3:(c3 = 70)"): 914738,
    ("t1000000m_c5c4c3:(c3 = 80)"): 914738,
    ("t1000000m_c5c4c3:(c3 = 90)"): 914738,
    ("t1000000m_c5c4c3:(c3 = ANY ('{10,20,30,40,50,60,70,80,90,100}'::integer[]))"): 914738,
    ("t1000000m_c5c4c3:(c3 = ANY ('{10,20,30,40,50,60,70,80,90}'::integer[]))"): 914738,
    ("t1000000m_c5c4c3:(c3 = ANY ('{10,20,30,40,50,60,70,80}'::integer[]))"): 914738,
    ("t1000000m_c5c4c3:(c3 = ANY ('{10,20,30,40,50,60,70}'::integer[]))"): 914738,
    ("t1000000m_c5c4c3:(c3 = ANY ('{10,20,30,40,50,60}'::integer[]))"): 914738,
    ("t1000000m_c5c4c3:(c3 = ANY ('{10,20,30,40,50}'::integer[]))"): 914738,
    ("t1000000m_c5c4c3:(c3 = ANY ('{10,20,30,40}'::integer[]))"): 914738,
    ("t1000000m_c5c4c3:(c3 = ANY ('{10,20,30}'::integer[]))"): 914738,
    ("t1000000m_c5c4c3:(c3 = ANY ('{10,20}'::integer[]))"): 914738,
    ("t1000000m_c5c4c3:(c3 = ANY ('{10,30,50,70,100}'::integer[]))"): 914738,
    ("t1000000m_c5c4c3:(c3 = ANY ('{10,50,100}'::integer[]))"): 914738,
    ("t1000000m_c5c4c3:(c3 = ANY ('{20,30,40,50,60,70,80,90,100}'::integer[]))"): 914738,
    ("t1000000m_c5c4c3:(c3 = ANY ('{30,40,50,60,70,80,90,100}'::integer[]))"): 914738,
    ("t1000000m_c5c4c3:(c3 = ANY ('{40,50,60,70,80,90,100}'::integer[]))"): 914738,
    ("t1000000m_c5c4c3:(c3 = ANY ('{50,60,70,80,90,100}'::integer[]))"): 914738,
    ("t1000000m_c5c4c3:(c3 = ANY ('{60,70,80,90,100}'::integer[]))"): 914738,
    ("t1000000m_c5c4c3:(c3 = ANY ('{70,80,90,100}'::integer[]))"): 914738,
    ("t1000000m_c5c4c3:(c3 = ANY ('{80,90,100}'::integer[]))"): 914738,
    ("t1000000m_c5c4c3:(c3 = ANY ('{90,100}'::integer[]))"): 914738,
    ("t1000000m_c5c4c3:(c4 <= 50)"): 100000,
    ("t1000000m_c5c4c3:(c4 = 100)"): 100000,
    ("t1000000m_c5c4c3:(c4 = 12)"): 100000,
    ("t1000000m_c5c4c3:(c4 = 2)"): 100000,
    ("t1000000m_c5c4c3:(c4 = 24)"): 100000,
    ("t1000000m_c5c4c3:(c4 = 34)"): 100000,
    ("t1000000m_c5c4c3:(c4 = 44)"): 100000,
    ("t1000000m_c5c4c3:(c4 = 50)"): 100000,
    ("t1000000m_c5c4c3:(c4 = 56)"): 100000,
    ("t1000000m_c5c4c3:(c4 = 66)"): 100000,
    ("t1000000m_c5c4c3:(c4 = 78)"): 100000,
    ("t1000000m_c5c4c3:(c4 = 88)"): 100000,
})
